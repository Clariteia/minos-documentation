

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Building Interactions: Sagas &mdash; Minos Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Testing" href="testing.html" />
    <link rel="prev" title="Exposing Information: Query Service" href="query.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Minos Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">QuickStart</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="aggregate.html">Modeling the Domain: Aggregates</a></li>
<li class="toctree-l2"><a class="reference internal" href="command.html">Exposing Operations: Command Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html">Exposing Information: Query Service</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building Interactions: Sagas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attemptmicroservice"><code class="docutils literal notranslate"><span class="pre">Attempt</span></code>microservice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saga-creation-in-exammicroservice">SAGA creation in <code class="docutils literal notranslate"><span class="pre">Exam</span></code>microservice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saga-execution-in-exammicroservice">SAGA execution in <code class="docutils literal notranslate"><span class="pre">Exam</span></code>microservice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html">Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/_toc.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Minos Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="_toc.html">QuickStart</a> &raquo;</li>
        
      <li>Building Interactions: Sagas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/quickstart/saga.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-interactions-sagas">
<h1>Building Interactions: Sagas<a class="headerlink" href="#building-interactions-sagas" title="Permalink to this headline">¶</a></h1>
<p>Implement each business transaction that spans multiple services is a saga. A saga is a sequence of local transactions.
Each local transaction updates the database and publishes a message or event to trigger the next local transaction in
the saga. If a local transaction fails because it violates a business rule then the saga executes a series of
compensating transactions that undo the changes that were made by the preceding local transactions.</p>
<p>In this section we will define a fictitious microservice <code class="docutils literal notranslate"><span class="pre">Attempt</span></code> and how to compose and call a SAGA.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Exam aggregate can be viewed at <a class="reference internal" href="aggregate.html"><span class="doc">Modeling the Domain: Aggregates</span></a></p>
<p>In order to make an example with SAGA we will need another fictitious microservice to simulate a communication.</p>
<p>In this case we are going to create one called attempts, in order to control for example that a user does not exceed
the number of attempts of an exam.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;attempt/src/aggregates.py&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">annotations</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">minos.common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Aggregate</span><span class="p">,</span>
    <span class="n">AggregateRef</span><span class="p">,</span>
    <span class="n">Entity</span><span class="p">,</span>
    <span class="n">EntitySet</span><span class="p">,</span>
    <span class="n">ModelRef</span><span class="p">,</span>
    <span class="n">ValueObject</span><span class="p">,</span>
    <span class="n">ValueObjectSet</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">Attempt</span><span class="p">(</span><span class="n">Aggregate</span><span class="p">):</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">ModelRef</span><span class="p">[</span><span class="n">User</span><span class="p">]</span>
    <span class="n">exam</span><span class="p">:</span> <span class="n">ModelRef</span><span class="p">[</span><span class="n">Exam</span><span class="p">]</span>
    <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="nf">validate_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">6</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">AggregateRef</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">class</span> <span class="nc">Exam</span><span class="p">(</span><span class="n">AggregateRef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exam reference&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="attemptmicroservice">
<h2><code class="docutils literal notranslate"><span class="pre">Attempt</span></code>microservice<a class="headerlink" href="#attemptmicroservice" title="Permalink to this headline">¶</a></h2>
<p>We need to define the Command to return if the number of attempts to perform the test for a user has been exceeded:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;attempt/src/commands.py&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">minos.common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EntitySet</span><span class="p">,</span>
    <span class="n">Condition</span><span class="p">,</span>
    <span class="n">MinosException</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.cqrs</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CommandService</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.networks</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Request</span><span class="p">,</span>
    <span class="n">Response</span><span class="p">,</span>
    <span class="n">enroute</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.saga</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SagaContext</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">..aggregates</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Attempt</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.sagas</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ADD_CART_ITEM</span><span class="p">,</span>
    <span class="n">DELETE_CART</span><span class="p">,</span>
    <span class="n">REMOVE_CART_ITEM</span><span class="p">,</span>
    <span class="n">UPDATE_CART_ITEM</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">class</span> <span class="nc">AttemptCommandService</span><span class="p">(</span><span class="n">CommandService</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cart Command Service class&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@enroute</span><span class="o">.</span><span class="n">broker</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;GetUserAttempts&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_attempts</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new cart.</span>
<span class="sd">        :param request: A request instance containing the information to build a payment instance.</span>
<span class="sd">        :return: A response containing the newly created payment instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span>
        <span class="n">exam</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;exam&quot;</span><span class="p">]</span>

        <span class="n">condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="o">.</span><span class="n">AND</span><span class="p">(</span>
            <span class="n">Condition</span><span class="o">.</span><span class="n">EQUAL</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">),</span>
            <span class="n">Condition</span><span class="o">.</span><span class="n">EQUAL</span><span class="p">(</span><span class="s2">&quot;exam&quot;</span><span class="p">,</span> <span class="n">exam</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="n">Attempt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">quantity</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">MinosException</span><span class="p">(</span><span class="s2">&quot;The maximum number of attempts has been exceeded.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="saga-creation-in-exammicroservice">
<h2>SAGA creation in <code class="docutils literal notranslate"><span class="pre">Exam</span></code>microservice<a class="headerlink" href="#saga-creation-in-exammicroservice" title="Permalink to this headline">¶</a></h2>
<p>The saga consists of steps and are those that define the operations to be performed in an orderly way to communicate with other
services. These steps normally contain the call to the corresponding service (<code class="docutils literal notranslate"><span class="pre">.invoke_participant(&quot;CreateOrder&quot;)</span></code>) and
optionally a compensation (<code class="docutils literal notranslate"><span class="pre">.with_compensation(&quot;DeleteOrder&quot;,</span> <span class="pre">delete_order_callback)</span></code>) in case an error occurs or the
operation cannot be performed by the business logic. It also optionally has a function in charge of
receiving the response from the invoked service (which is used in case the response has to be processed).</p>
<p>For a SAGA instance to be valid, a <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">invoke_participant</span></code> and <code class="docutils literal notranslate"><span class="pre">commit</span></code> are required. So the minimum structure of
a SAGA is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Saga</span><span class="p">()</span>
<span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="o">.</span><span class="n">invoke_participant</span><span class="p">(</span><span class="s2">&quot;GetUserAttempts&quot;</span><span class="p">)</span>
<span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we can create the SAGA that would call the <code class="docutils literal notranslate"><span class="pre">GetUserAttempts</span></code> command of the Attempt microservice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;exam/src/commands.py&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">minos.saga</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Saga</span><span class="p">,</span>
    <span class="n">SagaContext</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">src.aggregates</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Exam</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Aggregate</span><span class="p">,</span>
    <span class="n">Model</span><span class="p">,</span>
    <span class="n">ModelType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">UUID</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">AttemptQuery</span> <span class="o">=</span> <span class="n">ModelType</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">&quot;PaymentQuery&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span> <span class="s2">&quot;exam&quot;</span><span class="p">:</span> <span class="n">UUID</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">_prepare_data</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">SagaContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">AttemptQuery</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;user_uuid&quot;</span><span class="p">],</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;exam_uuid&quot;</span><span class="p">])</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">commit_result</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">SagaContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SagaContext</span><span class="p">:</span>
    <span class="n">exam</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Exam</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SagaContext</span><span class="p">(</span><span class="n">exam</span><span class="o">=</span><span class="n">exam</span><span class="p">)</span>

<span class="n">GET_USER_ATTEMPTS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Saga</span><span class="p">()</span>
    <span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="o">.</span><span class="n">invoke_participant</span><span class="p">(</span><span class="s2">&quot;GetUserAttempts&quot;</span><span class="p">,</span> <span class="n">_prepare_data</span><span class="p">)</span>
    <span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">commit_result</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>Normally if you want to send information together with the command, ModelType.build is used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AttemptQuery</span> <span class="o">=</span> <span class="n">ModelType</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">&quot;PaymentQuery&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span> <span class="s2">&quot;exam&quot;</span><span class="p">:</span> <span class="n">UUID</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p>To see the structure of the SAGA in detail visit <a class="reference internal" href="../architecture/saga.html"><span class="doc">Saga Pattern</span></a></p></li>
</ol>
</div>
<div class="section" id="saga-execution-in-exammicroservice">
<h2>SAGA execution in <code class="docutils literal notranslate"><span class="pre">Exam</span></code>microservice<a class="headerlink" href="#saga-execution-in-exammicroservice" title="Permalink to this headline">¶</a></h2>
<p>When sending the test results we will check that the user has not exceeded the limit of attempts, if so, an exception
is thrown.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;exam/src/commands/services.py&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">minos.cqrs</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CommandService</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.networks</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Request</span><span class="p">,</span>
    <span class="n">Response</span><span class="p">,</span>
    <span class="n">ResponseException</span><span class="p">,</span>
    <span class="n">enroute</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">minos.saga</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SagaContext</span><span class="p">,</span>
    <span class="n">SagaStatus</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">..aggregates</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">PaymentDetail</span><span class="p">,</span>
    <span class="n">ShipmentDetail</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.sagas</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GET_USER_ATTEMPTS</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">class</span> <span class="nc">ExamCommandService</span><span class="p">(</span><span class="n">CommandService</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exam Service class&quot;&quot;&quot;</span>

    <span class="nd">@enroute</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;/exams&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>
    <span class="nd">@enroute</span><span class="o">.</span><span class="n">broker</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;CreateExam&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">submit_exam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>

        <span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
        <span class="n">user_uuid</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;user_uuid&quot;</span><span class="p">]</span>
        <span class="n">exam_uuid</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;exam_uuid&quot;</span><span class="p">]</span>

        <span class="n">saga</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">saga_manager</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">GET_USER_ATTEMPTS</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="n">SagaContext</span><span class="p">(</span>
                <span class="n">user_uuid</span><span class="o">=</span><span class="n">user_uuid</span><span class="p">,</span>
                <span class="n">exam_uuid</span><span class="o">=</span><span class="n">exam_uuid</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">saga</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">SagaStatus</span><span class="o">.</span><span class="n">Finished</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">saga</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;exam&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResponseException</span><span class="p">(</span><span class="s2">&quot;An error occurred during exam submit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="testing.html" class="btn btn-neutral float-right" title="Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="query.html" class="btn btn-neutral float-left" title="Exposing Information: Query Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Clariteia.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>